<div class="">
  <h3 class="mb-3">Wishlist</h3>

    <!-- Loader -->
    <div *ngIf="loading" class="cart-loader">
      <div class="custom-spinner"></div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && wishlist.length === 0" class="bg-white p-3 rounded shadow">
      <div class="row">
        <div class="col-12 text-center p-5">
          <img src="images/empty-cart.svg" alt="Empty Wishlist" class="mb-3" style="height: 200px;" />
          <h2>Your wishlist is currently empty</h2>
          <p class="text-muted">Browse products and add them to your wishlist.</p>
          <a routerLink="/shop" class="btn btn-primary">Start Shopping</a>
        </div>
      </div>
    </div>

    <!-- Wishlist Table (Responsive) -->
    <div class="site-blocks-table" *ngIf="!loading && wishlist.length > 0">
      <div class="table-responsive">
        <table class="table mt-3">
          <thead>
            <tr>
              <th class="product-thumbnail">Image</th>
              <th class="product-name">Product</th>
              <th class="product-price text-end">Price</th>
              <th class="text-center">Add to Cart</th>
              <th class="text-center">Remove</th> <!-- ✅ now total 5 columns -->
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of wishlist">
              <td class="product-thumbnail">
                <img [src]="getCartImageUrl(item)" alt="Product Image" class="img-fluid cart-img p-2" />

              </td>
              <td class="product-name text-start">
                <h2 class="h6 text-black mb-1">{{ item.product.name }}</h2>
                <!-- Inside product-name cell -->
                <p *ngIf="item.variant?.variantAttributes?.length" class="text small mb-1 text-start">
                  <ng-container *ngFor="let attr of item.variant.variantAttributes; let i = index">
                    {{ attr.attributeValue?.attribute?.name }}: {{ attr.attributeValue?.value }}
                    <span *ngIf="i < item.variant.variantAttributes.length - 1">|</span>
                  </ng-container>
                </p>


                <p *ngIf="(item.variant?.stock ?? item.product.stock) === 0" class="badge bg-danger ms-2">
                  Out of Stock
                </p>

                <!-- ✅ Added -->

              </td>
              <td class="text-end fw-bold">
                {{ format ( item.variant?.price ?? item.product.price ) }}
              </td>


              <!--  Add to Cart Button -->
              <td class="text-center">
                <button (click)="moveToCart(item)" class="btn btn-outline-primary btn-lg"
                  [disabled]="(item.variant?.stock ?? item.product.stock) === 0"
                  [title]="(item.variant?.stock ?? item.product.stock) === 0 ? 'Out of Stock' : 'Add to Cart'">
                  <i class="bi bi-cart-plus"></i>
                </button>
              </td>



              <!--  Remove Button -->
              <td class="text-center">
                <button (click)="removeItem(item.product.id, item.variant?.id ?? null)"
                  class="btn btn-outline-danger btn-sm">
                  <i class="bi bi-trash trash-icon"></i>
                </button>
              </td>

            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>
